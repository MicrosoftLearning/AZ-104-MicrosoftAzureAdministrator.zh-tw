---
lab:
  title: 實驗室 09a：實作 Web 應用程式
  module: Administer PaaS Compute Options
---

# 實驗 09a - 實作 Web 應用程式


## 實驗室簡介

在此實驗室中，您將了解 Azure Web 應用程式。 您將學習如何設定 Web 應用程式，以便在外部 GitHub 存放庫顯示 Hello World 應用程式。 您將了解如何建立預備位置，並與生產位置交換。 您也會了解自動縮放以因應需求變更。

此實驗室需要 Azure 訂用帳戶。 您的訂用帳戶類型可能會影響此實驗室中的功能可用性。 您可以變更區域，但這些步驟是使用「美國東部」區域撰寫而成。

## 預估時間：20 分鐘

## 實驗案例

您的組織對裝載公司網站的 Azure Web 應用程式很感興趣。 該網站目前裝載於內部部署資料中心。 該網站使用 PHP 執行階段堆疊，並在 Windows 伺服器上執行。 該硬體的生命週期即將結束，並需要在短期內更換。 您的組織想要使用 Azure 來裝載網站，以避免產生新的硬體成本。 

## 互動式實驗室模擬

>**附註**： 先前提供的實驗室模擬已淘汰。

## 架構圖

![工作的圖表。](../media/az104-lab09a-architecture.png)

## 作業技能

+ 工作 1：建立及設定 Azure Web 應用程式。
+ 工作 2： 建立和設定部署位置。
+ 工作 3：設定 Web 應用程式部署設定。
+ 工作 4：交換部署位置。
+ 工作 5：設定並測試 Azure Web 應用程式的自動縮放功能。

## 工作 1：建立及設定 Azure Web 應用程式

在這項工作中，您會建立一個 Azure Web 應用程式。 Azure App Service 是 Web、行動和其他 Web 型應用程式的平台即服務 (PAAS) 解決方案。 Azure Web 應用程式屬於裝載大部分執行階段環境 (例如 PHP、Java 和 .NET) 的 Azure App Services。 您選取的 App Service 方案會決定 Web 應用程式的計算、儲存體和功能。 

1. 登入 **Azure 入口網站** - `https://portal.azure.com`。

1. 搜尋並選取 `App services`。

1. 從下拉功能表中依序選取 [+ Create]**** 和 [Web 應用程式]****。 請留意其他選項。 

1. 在 [建立 Web 應用程式] 刀鋒視窗的 [基本] 索引標籤上，指定下列設定 (其他設定請保留預設值)：

    | 設定 | 值 |
    | --- | ---|
    | 訂用帳戶 | 您的 Azure 訂用帳戶 |
    | 資源群組 | `az104-rg9` (如有必要，請選取 [新建]****) |
    | Web 應用程式名稱 | 任何全域唯一名稱 |
    | 發佈 | **程式碼** |
    | 執行階段堆疊 | **PHP 8.2** |
    | 作業系統 | **Linux** |
    | 區域 | **美國東部** |
    | 定價方案 | **高級 V3 P1V3** |
    | 區域備援 | 接受預設值 |

 1. 按一下 [檢閱 + 建立]****，然後按一下 [建立]****。

    >**注意**：請等到 Web 應用程式建立完畢，再繼續進行下一項工作。 這應該大約需要 1 分鐘的時間。
    
    >**附註**：如果部署失敗，請變更為另一個區域，然後重試。 這是由於不同地區的配額。  

1. 部署之後，選取 [前往資源]****。

## 工作 2：建立及設定一個部署位置

在此工作中，您將建立預備部署位置。 部署位置可讓您先執行測試，再讓應用程式公開推出 (或向使用者推出)。 執行測試之後，您可以將開發位置或預備位置交換至生產位置。 許多組織會使用位置來執行生產前測試。 此外，許多組織會針對每個應用程式執行多個位置 (例如開發、QA、測試和生產位置)。

1. 在新部署 Web 應用程式的刀鋒視窗上，按一下 [預設網域]**** 連結，以在新的瀏覽器索引標籤中顯示預設網頁。

1. 請關閉新瀏覽器索引標籤，然後回到 Azure 入口網站，在 [Web 應用程式] 刀鋒視窗的 [部署]**** 區段中，按一下 [部署位置]****。

1. 按一下 [新增位置]****，並使用下列設定新增位置:

    | 設定 | 值 |
    | --- | ---|
    | 名稱 | `staging` |
    | 從下列複製設定 | **不要複製設定**|

1. 選取 [新增]** 以**建立插槽。

1. 重新整理頁面以檢視 Production 和 Staging 插槽。 

1. 選取代表新建立的暫存插槽的項目。

    >**注意**：這將開啟顯示預備位置屬性的刀鋒視窗。

1. 檢閱預備位置刀鋒視窗，並注意其 URL 與指派給生產位置的 URL 不同。

## 工作 3：設定 Web 應用程式部署設定

在這項工作中，您將設定 Web 應用程式部署設定。 部署設定可允許持續部署。 這可確保應用程式服務具有最新版本的應用程式。

1. 在預備位置中，依序選取 [部署中心]**** 和 [設定] ****。

    >**注意：** 請確定您位於預備位置刀鋒視窗窗格 (而非生產位置)。
    
1. 在 [來源]**** 下拉式清單中，選取 [外部 Git]****。 請留意其他選項。 

1. 在 [存放庫] 欄位中輸入 `https://github.com/Azure-Samples/php-docs-hello-world`

1. 在 [分支] 欄位中輸入 `master`。

1. 選取 [儲存]。

1. 從預備位置選取 [概觀]****。

1. 選取 [預設網域]**** 連結，然後在新的索引標籤中開啟 URL。 

1. 確認預備位置會顯示 **Hello World**。 

>**注意：** 部署可能需要幾分鐘時間。 請務必**重新整理**應用程式頁面。

## 工作 4：交換部署位置

在這項工作中，您會交換預備位置與生產位置。 交換位置可讓您使用已在預備位置中測試的程序代碼，並將其移至生產位置。 如果您需要移動已針對位置自訂的其他應用程式設定，Azure 入口網站也會對您進行提示。 交換位置是應用程式小組和應用程式支援小組的常見工作，對負責部署例行應用程式更新和錯誤修正的小組來說更是如此。

1. 瀏覽回 [部署位置]**** 刀鋒視窗，然後選取 [交換]****。

1. 檢閱預設設定，然後按一下 **開始交換**。 等待交換已完成的通知。

1. 返回入口網站首頁。 您應該同時擁有生產 Web 應用程式和預備位置。

1. 搜尋 `App Services` 並選取您的 App Service Web 應用程式。 這會將您返回 Production Deployment 插槽。

1. 選取 App Service Web 應用程式，然後在 Web 應用程式的 [概觀 **] **刀鋒視窗上選取 [預設網域 **] **連結以顯示網站首頁。

1. 確認生產網頁現在顯示 **Hello World！** 頁面。

    >**注意：** 複製預設網域 **URL**，您將需要在下一個工作中進行負載測試。 

## 工作 5：設定並測試 Azure Web 應用程式的自動縮放

在此工作中，您將設定 Azure Web 應用程式的自動縮放。 自動縮放可讓您在 Web 應用程式流量增加時，維持 Web 應用程式的最佳效能。 若要判斷應用程式何時應縮放大小，您可以監視 CPU 使用量、記憶體或頻寬等計量。

1. 在左窗格的 [App Service 方案 **] **區段中，選取 [**向外**延展]。

    >**注意：** 確保您正在生產插槽上工作，而不是在暫存插槽上工作。  

1. 從 [縮放]**** 區段中選取 [自動]****。 請注意 [Rules Based]**** 選項。 規則型縮放可以針對不同的應用程式計量進行設定。 

1. 在 [高載上限]**** 欄位中選取 [2]****。

    ![自動縮放頁面的螢幕擷取畫面。](../media/az104-lab09a-autoscale.png)

1. 選取 [儲存]。

1. 選取 [診斷並解決問題]**** (左窗格)。

1. 在 [Load Test your App]**** 方塊中，選取 [建立負載測試]****。

    + 選取 [+ Create]****，並為您的負載測試取一個**名稱**。  名稱必須是唯一的。
    + 選取 [檢閱 + 建立]****，然後選取 [建立]****。

1. 等候負載測試建立，然後選取 [前往資源]****。

1. 從 概觀** | **透過**新增HTTP要求**建立，選取 建立。****

1. 在 [測試計劃] **索引標籤上，按一下 [**新增要求**]。** 在 URL 欄位**** 中，貼上您的**預設網域** URL。 請確定 URL 已正確格式化，並以 **https://** 開頭。 選取 [新增]**** 以儲存您的變更。 

1. 選取 [檢閱 + 建立]****，然後選取 [建立]****。

    >**注意：** 建立測試可能需要幾分鐘的時間。 觀看通知。

1. 導覽至測試 （它會列在首頁上）。 

1. 重新整理並檢閱即時計量，包括 **虛擬使用者**、 **回應時間**和 **要求/秒**。

1. 選取 [停止]****，以完成測試回合。 您無需等待測試完成。 

## 清除您的資源

如果您使用**自己的訂用帳戶**，請花點時間刪除實驗室資源。 如此可確保釋出資源，並將成本降到最低。 刪除實驗室資源的最簡單方式是刪除實驗室資源群組。 

+ 在 Azure 入口網站中，選取資源群組，選取 [刪除資源群組]****，[輸入資源群組名稱]****，然後按一下 [刪除]****。
+ 使用 Azure PowerShell `Remove-AzResourceGroup -Name resourceGroupName`。
+ 使用 CLI `az group delete --name resourceGroupName`。

## 利用 Copilot 延伸學習
Copilot 可協助您了解如何使用 Azure 指令碼工具。 Copilot 也可在實驗室中未涵蓋的區域或您需要更多資訊的地方提供協助。 開啟 Edge 瀏覽器，然後選擇 [Copilot] (右上方)，或瀏覽至 *copilot.microsoft.com*。 請花幾分鐘的時間嘗試下列提示。

+ 摘要說明建立和設定 Azure Web 應用程式的步驟。
+ 有哪些方式可以縮放 Azure Web 應用程式?

## 透過自學型訓練深入了解

+ [使用 App Service 部署位置來預備 Web 應用程式部署，以進行測試和復原](https://learn.microsoft.com/training/modules/stage-deploy-app-service-deployment-slots/)。 在 Azure App Service 中使用部署位置來簡化部署及復原 Web 應用程式。
+ [調整 App Service web 應用程式的規模，以有效率方式滿足 App Service 相應增加和相應放大的需求](https://learn.microsoft.com/training/modules/app-service-scale-up-scale-out/)。以累加方式增加可用資源來回應活動增加的時段，然後在活動下降時減少這些資源以降低成本。

## 重要心得

恭喜您完成此實驗室。 以下是此實驗室的主要重點。 

+ Azure App Service 可讓您快速建置、部署及縮放 Web 應用程式。
+ App Service 可支援許多開發人員環境，包括 ASP.NET、Java、PHP 和 Python。
+ 部署位置可讓您建立不同的環境，以部署及測試 Web 應用程式。
+ 您可以手動或自動縮放 Web 應用程式，以處理其他需求。
+ 可提供各種不同的診斷和測試工具。 
