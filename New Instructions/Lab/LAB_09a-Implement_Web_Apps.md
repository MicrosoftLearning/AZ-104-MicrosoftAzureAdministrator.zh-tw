---
lab:
  title: 實驗室 09a：實作 Web Apps
  module: Administer PaaS Compute Options
---

# 實驗 09a - 實作 Web 應用程式


## 實驗室簡介

在此實驗室中，您將瞭解 Azure Web 應用程式。 您將瞭解如何設定 Web 應用程式，以在外部 GitHub 存放庫中顯示 Hello World 應用程式。 您將瞭解如何建立預備位置，並與生產位置交換。 您也會了解自動調整以因應需求變更。

此實驗室需要 Azure 訂用帳戶。 您的訂用帳戶類型可能會影響此實驗室中功能的可用性。 您可以變更區域，但步驟是使用美國東部撰寫。

## 預估時間：30 分鐘

## 實驗案例

您的組織對裝載公司網站的 Azure Web 應用程式感興趣。 網站目前裝載於內部部署數據中心。 網站會使用 PHP 執行時間堆疊在 Windows 伺服器上執行。 硬體即將結束生命週期，即將更換。 您的組織想要避免使用 Azure 來裝載網站來取代硬體。 

## 互動式實驗室模擬

您可能會發現互動式實驗室模擬對本主題很有用。 模擬可讓您以自己的步調點選類似的案例。 互動式模擬和此實驗室之間有差異，但許多核心概念都相同。 不需要 Azure 訂用帳戶。

+ [建立 Web 應用程式](https://mslearn.cloudguides.com/en-us/guides/AZ-900%20Exam%20Guide%20-%20Azure%20Fundamentals%20Exercise%202)。 建立執行 Docker 容器的 Web 應用程式。
    
+ [實作 Azure Web 應用程式](https://mslabs.cloudguides.com/guides/AZ-104%20Exam%20Guide%20-%20Microsoft%20Azure%20Administrator%20Exercise%2013)。 建立 Azure Web 應用程式、管理部署及調整應用程式。 

## 架構圖

![工作的圖表。](../media/az104-lab09a-architecture-diagram.png)

## 工作

+ 工作 1：建立 Azure Web 應用程式
+ 工作 2：建立預備部署位置
+ 工作 3：設定 Web 應用程式部署設定
+ 工作 4：交換預備位置
+ 工作 5：設定及測試 Azure Web 應用程式的自動調整

## 工作 1：建立 Azure Web 應用程式

在這項工作中，您會建立 Azure Web 應用程式。 Azure App 服務 是 Web、行動和其他 Web 應用程式的平臺即服務 （PAAS） 解決方案。 Azure Web 應用程式是裝載大部分運行時間環境的一部分 Azure App 服務，例如 PHP、Java 和 .NET。 您選取的 SKU 會決定您透過 Web 應用程式收到的計算、記憶體和功能數量。

1. 登入 **Azure 入口網站** - `https://portal.azure.com`。

1. 搜尋並選取 `App services`。

1. **從下拉功能表 **[Web 應用程式**] 中選取 [+ 建立**]。 請注意其他選項。 

1. 在 [建立 Web 應用程式] 刀鋒視窗的 [基本] 索引標籤上，指定下列設定 (其他設定請保留預設值)：

    | 設定 | 值 |
    | --- | ---|
    | 訂用帳戶 | 您的 Azure 訂用帳戶 |
    | 資源群組 | `az104-rg9`（如有必要，請選取**** 新增） |
    | Web 應用程式名稱 | 任何全域唯一名稱 |
    | 發佈 | **程式碼** |
    | 執行階段堆疊 | **PHP 8.2** |
    | 作業系統 | **Linux** |
    | 區域 | **美國東部** |
    | 定價方案 | 接受預設值 |
    | 區域備援 | 接受預設值 |

 1. 按兩下 [ **檢閱 + 建立**]，然後按兩下 [ **建立**]。

    >**注意**：等到建立 Web 應用程式，再繼續進行下一個工作。 這應該大約需要 1 分鐘的時間。

1. 部署之後，選取 **[移至資源**]。

## 工作 2：建立預備部署位置

在此工作中，您將建立預備部署位置。 部署位置可讓您先執行測試，再讓應用程式可供公眾使用（或使用者）。 執行測試之後，您可以將位置從開發或預備交換至生產環境。 許多組織會使用位置來執行生產前測試。 此外，許多組織會針對每個應用程式執行多個位置（例如開發、QA、測試和生產環境）。

1. 在新部署 Web 應用程式的刀鋒視窗上，按兩下 **[預設網域** ] 連結，在新的瀏覽器索引標籤顯示預設網頁。

1. 關閉新的瀏覽器索引標籤，然後在 [Web 應用程式] 刀鋒視窗的 [部署 **] 區段中，** 回到 [Azure 入口網站] 中，按兩下 **[部署位置**]。

    >**注意**：此時 Web 應用程式具有標示為 PRODUCTION** 的單一部署位置**。

1. 按一下 [+ 新增位置]，並使用下列設定新增位置：

    | 設定 | 值 |
    | --- | ---|
    | 名稱 | `staging` |
    | 從下列複製設定 | **不要複製設定**|

1. 選取**新增**。

1. 回到 Web 應用程式的 [ **部署位置] 刀鋒視窗，按兩下代表新建立預備位置** 的專案。

    >**注意**：這將開啟顯示預備位置屬性的刀鋒視窗。

1. 檢閱預備位置刀鋒視窗，並注意其 URL 與指派給生產位置的 URL 不同。

## 工作 3：設定 Web 應用程式部署設定

在這項工作中，您將設定 Web 應用程式部署設定。 部署設定可讓您從您選擇的存放庫，或使用 FTPS 認證和其他自動化，持續部署。 這可確保應用程式服務具有最新版本的應用程式。

1. 在預備位置中，選取 **[部署中心**]，然後選取 **[設定**]。

    >**注意：** 請確定您位於預備位置刀鋒視窗上（而不是生產位置）。
    
1.In [ **來源** ] 下拉式清單，選取 **[外部 Git**]。

1. 在 [存放庫] 欄位中，輸入 `https://github.com/Azure-Samples/php-docs-hello-world`

1. 在分支欄位中，輸入 `master`。

1. 選取 [儲存]。

1. 從預備位置選取 [ **概觀**]。

1. 選取 [ **預設網域** ] 鏈接，然後在新的索引標籤中開啟 URL。 

1. 確認預備位置顯示 **Hello World**。

>**注意：** 部署可能需要一分鐘的時間。 請務必重新 **整理** 應用程式頁面。

## 工作 4：交換預備位置

在這項工作中，您會將預備位置與生產位置交換。 交換位置可讓您使用已在預備位置中測試的程序代碼，並將它移至生產環境。 如果您需要移動已針對位置自定義的其他應用程式設定，Azure 入口網站 也會提示您。 交換位置是應用程式小組和應用程式支援小組的常見工作，尤其是部署例行應用程式更新和錯誤修正的工作。

1. 流覽回 [ **部署位置]** 刀鋒視窗，然後選取 [ **交換**]。

1. 檢閱預設設定，然後按兩下 [ **交換**]。

1. 在 Web 應用程式的 [ **概觀** ] 刀鋒視窗上，選取 [ **預設網域** ] 鏈接以顯示網站首頁。

1. 確認生產網頁顯示 **Hello World！** 頁面。

    >**注意：** 複製您在下一個工作中進行負載測試所需的預設網域 **URL** 。 

## 工作 5：設定及測試 Azure Web 應用程式的自動調整

在這項工作中，您將設定 Azure Web 應用程式的自動調整。 自動調整可讓您在 Web 應用程式流量增加時維持 Web 應用程式的最佳效能。 若要判斷應用程式何時應調整規模，您可以監視計量，例如CPU使用量、記憶體或頻寬。

1. 在 **[設定]** 區段中，選取 [**向外延展][App Service 方案]。**

    >**注意：** 請確定您使用的是生產位置，而不是預備位置。  

1. 從 [ **調整]** 區段中，選取 [ **自動**]。 請注意 [ **規則型** ] 選項。 規則型調整可以針對不同的應用程式計量進行設定。 

1. 在 [ **最大高載** ] 字段中，選取 **[2**]。

    ![自動調整頁面的螢幕快照。](../media/az104-lab09a-autoscale.png)

1. 選取 [儲存]。

1. 選取 [ **診斷並解決問題** ] （左窗格）。

1. 在 [ **負載測試您的應用程式** ] 方塊中，選取 [ **建立負載測試**]。

    + 選取 **[+ 建立**]，併為您的負載測試命名****。  名稱必須是唯一的。
    + 選取 [檢閱 + 建立]****，然後選取 [建立]****。

1. 等候負載測試建立，然後選取 **[移至資源**]。

1. 從 [概觀** | **] [** 新增 HTTP 要求**]，選取 [**建立]。**

1. 針對 [ **測試 URL**]，貼上您的 **預設網域** URL。 請確定此格式正確，且開頭 **為 https://**。

1. 選取 [檢閱 + 建立]****，然後選取 [建立]****。

    >**注意：** 建立測試可能需要幾分鐘的時間。 

1. 檢閱測試結果，包括 **虛擬使用者**、 **回應時間**和 **要求/秒**。

1. 選取 [ **停止** ] 以完成測試回合。
   
## 重要心得

恭喜您完成實驗室。 以下是此實驗室的主要外賣。 

+ Azure App 服務 可讓您快速建置、部署及調整 Web 應用程式。
+ App Service 包含許多開發人員環境的支援，包括 ASP.NET、Java、PHP 和 Python。
+ 部署位置可讓您建立不同的環境，以部署及測試 Web 應用程式。
+ 您可以手動或自動調整 Web 應用程式以處理其他需求。
+ 提供各種不同的診斷和測試工具。 

## 清除您的資源

如果您使用自己的訂用帳戶，需要一分鐘的時間才能刪除實驗室資源。 這可確保資源可以釋出，並將成本降到最低。 刪除實驗室資源最簡單的方式是刪除實驗室資源群組。 

+ 在 Azure 入口網站 中，選取資源群組、選取 **[刪除資源群組**]、**輸入資源組名**，然後按兩下 [**刪除**]。
+ 使用 Azure PowerShell， `Remove-AzResourceGroup -Name resourceGroupName`。
+ 使用 CLI， `az group delete --name resourceGroupName`。
    
