---
lab:
  title: 實驗室 03b：使用 ARM 範本管理 Azure 資源
  module: Administer Azure Resources
---

# 實驗 03b - 使用 ARM 範本管理 Azure 資源
# 學生實驗室手冊

## 實驗案例
您的小組已探索基本的 Azure 系統管理功能，例如布建資源，並根據資源群組加以組織。 接下來，您的小組想要查看自動化和簡化部署的方式。 組織通常會尋求自動化，以減少系統管理額外負荷、減少人為錯誤或增加一致性，以及讓系統管理員能夠處理更複雜的或創造性的工作。

**注意：** **[互動式實驗室模擬](https://mslabs.cloudguides.com/guides/AZ-104%20Exam%20Guide%20-%20Microsoft%20Azure%20Administrator%20Exercise%205)** (英文) 可供您以自己的步調完成此實驗室。 您可能會發現互動式模擬與託管實驗室之間稍有差異，但所示範的核心概念與想法均相同。 

## 目標

在此實驗中，您將會：

+ 工作 1：建立 ARM 範本以部署 Azure 受控磁碟
+ 工作 2：編輯 ARM 範本，然後使用範本建立 Azure 受控磁碟
+ 工作 3：檢閱受控磁碟的 ARM 範本型部署

## 預估時間：30 分鐘

## 架構圖

![image](./media/az104-lab03b-architecture-diagram.png)

### 指示

## 練習 1

## 工作 1：建立 ARM 範本以部署 Azure 受控磁碟
在這項工作中，您將使用 Azure 入口網站 來產生ARM範本。 然後，您可以下載範本，以在未來的部署中使用。 計劃部署數百或數千個磁碟的組織可以利用一或多個範本來協助自動化部署。 在此工作中，我們使用 Azure 入口網站。 您也可以將範本分解成 Azure Bicep。

1. 登入 [**Azure 入口網站**](http://portal.azure.com)。

1. 在 Azure 入口網站 中，搜尋並選取 `Disks`。

1. 在 [磁碟] 頁面上，選取 [ **建立**]。

1. 在 [建立受控磁碟] 頁面上，使用下列資訊來建立磁碟。
    
    | 設定 | 值 |
    | --- | --- |
    | 訂用帳戶 | 您使用的訂用帳戶 | 
    | 資源群組 | `az104-rg1` （如有必要，請選取 **建立 new**。）
    | 磁碟名稱 | `az104-disk1` | 
    | 區域 | **美國東部** |
    | 可用性區域 | **不需要基礎結構備援** | 
    | 來源類型 | **None** |
    | 大小 | **32 Gb** | 
    | 效能 | **標準 HDD** |

    ![image](./media/az104-lab03b-createdisk.png)

1. 按兩下 [**檢閱 + 建立***] 一次*。 請勿**** 實際部署資源。

1. 在 [檢閱 + 建立] 索引標籤上，按兩下 [ **下載自動化**的範本]。

1. 檢閱範本上顯示的資訊，包括所建立的參數和資源。

1. 按兩下 [ **下載** ]，並將範本儲存至您的電腦。

1. 將下載檔案的內容解壓縮到 **您電腦上的 [下載** ] 資料夾中。

    
1. 關閉所有 [檔案總管] 視窗。

1. 在 Azure 入口網站 中，取消受控磁碟的部署。

## 工作 2：編輯 ARM 範本，然後使用範本建立 Azure 受控磁碟
在這項工作中，您將使用您建立的 ARM 範本來部署新的受控磁碟。 此工作概述具有範本型部署的一般程式，讓您能夠快速且輕鬆地重複部署。 如果您需要變更參數或兩個參數，您未來可以輕鬆地修改範本。

1. 在 Azure 入口網站 中，搜尋並選取 `Deploy a custom template`。

1. 在 [自訂部署] 刀鋒視窗中按一下 [在編輯器中建置您自己的範本]。

1. 在 [編輯範本] 刀鋒視窗上，按一下 [載入檔案]，然後上傳您在上一個工作中下載的 **template.json** 檔案。

1. 在編輯器窗格中，移除下列幾行：

   ```json
    "sourceResourceId": {
            "type": "string"
    },
   ```
   
   ```json
      "hyperVGeneration": {
       "defaultValue": "V1",
       "type": "String"
   },      
   ```

    >**注意**：這些參數不適用於目前的部署，因此需要移除。 在這當中，sourceResourceId、sourceUri、osType 和 hyperVGeneration 參數適用於從現有的 VHD 檔案建立 Azure 磁碟。

1. **儲存**變更。

1. 返回 [自訂部署] 刀鋒視窗，然後按一下 [編輯參數]。 

1. 在 [編輯參數] 刀鋒視窗上，按一下 [載入檔案]，並上傳您在上一個工作中下載的 **parameters.json** 檔案，然後 [儲存] 變更。

1. 回到 [自訂部署] 刀鋒視窗，指定下列設定：

    | 設定 | 值 |
    | --- |--- |
    | 訂用帳戶 | *您在此實驗室中使用的 Azure 訂閱名稱* |
    | 資源群組 | `az104-rg1`（如有必要，請選取**** 新增）|
    | 區域 | 您在此實驗室中使用之訂用帳戶中可用的任何 Azure 區域名稱，通常是 **美國**東部。 |
    | 磁碟名稱 | `az104-disk1` |
    | Location | 您在上一個工作中所記錄的位置參數值 |
    | SKU | **Standard_LRS** |
    | 磁碟大小 (GB) | **32** |
    | 建立選項 | **empty** |
    | 磁碟加密集類型 | **EncryptionAtRestWithPlatformKey** |
    | 數據存取驗證模式 | 無 |
    | 網路存取原則 | **AllowAll** |
    | 公用網路存取 | 停用 |

    ![image](./media/az104-lab03b-customdeploy.png)

1. 選取 [檢閱 + 建立]，然後選取 [建立]。

1. 確認部署已成功完成。

## 工作 3：檢閱受控磁碟的 ARM 範本型部署
在這項工作中，您會確認部署已順利完成。 所有先前的部署都會記錄在部署的目標資源群組中。 此檢閱會顯示部署時間與長度之間的詳細數據，這在疑難解答時會很有説明。 最好先檢閱前幾個以範本為基礎的部署，以確保在使用範本進行大規模作業之前成功。

1. 在 Azure 入口網站中，搜尋並選取 [資源群組]。 

1. 在資源群組清單中，按兩下 **az104-rg1**。

1. 在 [az104-rg1** 資源群組] 刀鋒視窗的 **[設定**] 區段中，按兩下 **[部署**]。**

1. **從 az104-rg1 - Deployments** 刀鋒視窗，按兩下部署清單中的第一個專案，並檢閱 [輸入 **] 和 **[範本**] 刀鋒視窗的內容**。


## 檢閱

恭喜！ 在此實驗室中，您已使用 Azure 入口網站來建立受控磁碟的 ARM 範本，然後使用範本來部署新的磁碟。